#!/bin/bash
# smplOS launcher -- KDE-like category tabs + global typing search
#
# Behavior:
#   - Empty search: active tab filters list by category.
#   - Non-empty search: ignore active tab and search globally across all apps.
#   - Clearing search returns to current tab's category view.

THEME="$HOME/.config/rofi/smplos-launcher.rasi"
MODE="${1:-apps}"

# Ensure cache exists
[[ ! -f "$HOME/.cache/smplos/app_index" ]] && rebuild-app-cache 2>/dev/null

theme_args=()
[[ -f "$THEME" ]] && theme_args=(-theme "$THEME")

rofi -show "$MODE" -show-icons \
  -modi "multimedia:rofi-apps-multimedia-src,development:rofi-apps-development-src,graphics:rofi-apps-graphics-src,internet:rofi-apps-internet-src,office:rofi-apps-office-src,apps:rofi-apps-apps-src,settings:rofi-settings-src" \
  -display-multimedia "Multimedia" \
  -display-development "Development" \
  -display-graphics "Graphics" \
  -display-internet "Internet" \
  -display-office "Office" \
  -display-apps "Apps" \
  -display-settings "Settings" \
  "${theme_args[@]}"
